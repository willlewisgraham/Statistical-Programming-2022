---
title: "Project 1"
author: "Will Graham; Richelle Lee; Robin Lin"
date: '2022-09-29'
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Ctrl + Shift + H: Set Working Directory

```{r}
a <- scan("pg10.txt",what="character",skip=104) ## skip contents
n <- length(a)
a <- a[-((n-2886):n)] ## strip license
a <- a[-grep("[0123456789]:[0123456789]",a)] ## strip out verse numbers

# a <- a[1:100] # test
```

A Function Splitting Punctuation Marks

```{r}
indexes_split_punct <- function(string){
  ## Separating words with punctuation marks
  indexes <- grep("[^a-z ^A-Z]",a) ## obtain the indexes of words containing non-letter characters 
  return(indexes)
}

split_punct <- function(b, test){
  punct_indexes <- indexes_split_punct(b)
  punct <- b[punct_indexes]
  new_b <- c(1:(length(b) + length(punct)))
  tracker <- 0
  if (test == TRUE){
    b <- b[1:100]
    new_b <- new_b[1:115]
  }
  
  
  for (i in c(1:length(b))) {
    if (b[i] %in% punct) {
      new_b[i+tracker] <- substr(b[i], 1, nchar(b[i]) - 1)
      new_b[i + tracker + 1] <- substr(b[i], nchar(b[i]), nchar(b[i]))
      tracker <- tracker + 1
    } else {new_b[i + tracker] <- b[i]}
  }
  return(new_b)
}


```

```{r}
#Lowering capitals
new_b <- split_punct(a, TRUE)
lower_new_b <- tolower(new_b)
unique_words <- unique(lower_new_b)
index_match <- match(lower_new_b, unique_words)
tabulate_index_match <- tabulate(index_match)
sort_results <- sort(tabulate_index_match, index.return = TRUE, decreasing = TRUE)
top_500 <- sort_results$ix[1 : 10]
result_list <- unique_words[top_500]
```

```{r}
common_word_match <- match(lower_new_b, result_list)
first_column <- common_word_match[1 : (length(common_word_match) - 2)]
second_column <- first_column[2 : (length(common_word_match) - 1)]
third_column <- first_column[3 : length(common_word_match)]
T_array <- data.frame(first_column, second_column, third_column)

T_array <- T_array[is.na(rowSums(T_array)) == FALSE,]
print(result_list[T_array])

Index_to_common_words <- function(x){return(result_list[x])}
matrix_x <- cbind(c(lapply(T_array$first_column, FUN = Index_to_common_words)), c(lapply(T_array$second_column, FUN = Index_to_common_words)), c(lapply(T_array$third_column, FUN = Index_to_common_words)))

Inital_W_map <- unique(T_array$first_column)
Intial_word_probability <- tabulate(match(T_array$first_column, unique(T_array$first_column)))
Initail_prob <- Intial_word_probability/sum(Intial_word_probability)

second_W_map <- unique(T_array[1:2])
second_word_probability <- rep(0, length(second_W_map))

for(i in c(1:length(second_W_map[[1]]))) {
  for(j in c(1:length(T_array[[1]]))) {
    
    if (identical(T_array[j, c(1,2)], second_W_map [i,]))
    second_word_probability[i] <- second_word_probability [i] + 1
    
  }
  
}
```